dist: xenial
sudo: required
language: c

cache:
  directories:
    - $HOME/.conan/

addons:
  apt:
    packages:
    - pkg-config
    - ninja-build
    - libfreetype6-dev
    - libfreeimage-dev
    - libzzip-dev
    - libois-dev
    - libgl1-mesa-dev
    - libglu1-mesa-dev
    - libx11-dev
    - libxt-dev
    - libxaw7-dev
    - libxrandr-dev
    - libgtk2.0-dev
    - libwxgtk3.0-dev

install:
  - wget https://dl.bintray.com/conan/installers/conan-ubuntu-64_1_8_0.deb
  - sudo dpkg -i conan-ubuntu-64_1_8_0.deb
  - conan user
  - conan remote add ror-dependencies https://api.bintray.com/conan/anotherfoxguy/ror-dependencies || true
  - conan remote add bincrafters-public-conan https://api.bintray.com/conan/bincrafters/public-conan || true
  - conan install --build=missing -u .

script:
  - cmake -GNinja -DCMAKE_BUILD_TYPE=Release -DBUILD_APPIMAGE=ON .
  - ninja RoRConfig
  - ninja zip_and_copy_resources

after_success:
  - if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then sh ./.travis/build-and-upload-appimage.sh; fi
